utility functions of version 1